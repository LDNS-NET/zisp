<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Redirecting...</title>
  <style>
    body {
      background: #000;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
      padding-top: 100px
    }
  </style>
</head>

<body>
  <p>Redirecting...</p>
  <a href="#" id="manual-link" style="color:#aaf">Click if stuck</a>
  <script>
    var domain = "{{DOMAIN}}";
    var redirectUrl = 'https://' + domain + '/hotspot';
    var params = new URLSearchParams();

    // MikroTik variables
    var loginUrl = "$(link-login-only)";
    var linkOrig = "$(link-orig)";
    var error = "$(error)";
    var mac = "$(mac)";
    var ip = "$(ip)";

    if (mac && mac.indexOf('$') !== 0) params.append('mac', mac);
    if (ip && ip.indexOf('$') !== 0) params.append('ip', ip);
    if (linkOrig && linkOrig.indexOf('$') !== 0) params.append('orig', linkOrig);
    if (loginUrl && loginUrl.indexOf('$') !== 0) params.append('login_url', loginUrl);

    var urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('mac')) params.set('mac', urlParams.get('mac'));
    if (urlParams.get('ip')) params.set('ip', urlParams.get('ip'));
    if (urlParams.get('link-orig')) params.set('orig', urlParams.get('link-orig'));

    if (params.toString()) redirectUrl += '?' + params.toString();

    document.getElementById('manual-link').href = redirectUrl;
    window.location.replace(redirectUrl);
  </script>
</body>

</html>