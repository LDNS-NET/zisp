<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Login Failed</title>
  <style>
    body {
      background: #eb3349;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
      padding-top: 50px
    }

    a {
      color: #fff
    }
  </style>
</head>

<body>
  <h2>Login Failed</h2>
  <div id="error-message"></div>
  <p>Retrying in 2 seconds...</p>
  <a href="#" id="retry-link">Try Now</a>
  <script>
    var domain = "{{DOMAIN}}";
    var redirectUrl = 'https://' + domain + '/hotspot';
    var params = new URLSearchParams();

    var loginUrl = "$(link-login-only)";
    var errorVar = "$(error)";
    var mac = "$(mac)";
    var ip = "$(ip)";

    var urlParams = new URLSearchParams(window.location.search);
    var errorMsg = urlParams.get('error') || (errorVar && errorVar.indexOf('$') !== 0 ? errorVar : null);

    if (errorMsg) {
      document.getElementById('error-message').textContent = decodeURIComponent(errorMsg);
      params.append('error', errorMsg);
    }

    if (mac && mac.indexOf('$') !== 0) params.append('mac', mac);
    if (ip && ip.indexOf('$') !== 0) params.append('ip', ip);
    if (loginUrl && loginUrl.indexOf('$') !== 0) params.append('login_url', loginUrl);

    // Fallback
    if (urlParams.get('mac')) params.set('mac', urlParams.get('mac'));

    if (params.toString()) redirectUrl += '?' + params.toString();

    document.getElementById('retry-link').href = redirectUrl;
    setTimeout(function () { window.location.replace(redirectUrl); }, 2000);
  </script>
</body>

</html>